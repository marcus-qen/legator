# v1.0.0-alpha.30 â€” Stage 3.8.1 automation packs declarative workflow schema

## Highlights

### 1) New automation-pack workflow schema model

Added a machine-readable automation-pack definition model in `internal/controlplane/automationpacks` with first-class support for:

- metadata (`id`, `name`, `version`, `description`)
- typed inputs + validation constraints
- ordered workflow steps (`id`, `action`, `parameters`)
- approval requirements (workflow-level and step-level)
- expected outcomes / success criteria

### 2) Server-side validation layer

Added schema normalization + validation checks for:

- metadata ID and semantic-version format
- unique input names + unique step IDs
- input type contracts (`string|number|integer|boolean|array|object`)
- type-specific constraints (for example string length/regex vs numeric bounds)
- default/enum value type matching
- approval policy constraints (`minimum_approvers`, approver role bounds)
- expected outcome requirements and `step_id` references

### 3) Additive storage and API surface (definition lifecycle only)

Added persisted storage for automation-pack definitions (SQLite) and new additive REST endpoints:

- `POST /api/v1/automation-packs`
- `GET /api/v1/automation-packs`
- `GET /api/v1/automation-packs/{id}` (`?version=` optional)

This stage intentionally supports **definition CRUD-lite only** (create/list/get). Execution/orchestration lands in later stages.

### 4) Coverage + docs

- Added tests for schema validation failure/success paths.
- Added store tests for create/list/get/latest-version/duplicate handling.
- Added handler tests for API behavior + error mapping.
- Added server permission coverage for automation-pack routes.
- Added docs: `docs/automation-packs.md` and README updates.

## Compatibility

- [compat:additive] Added automation-pack definition routes and payloads without removing or renaming existing REST or MCP identifiers.
