# v1.0.0-beta.1 — First Public Beta

**Release date:** 2026-03-02
**Tag:** `v1.0.0-beta.1`
**Status:** Production-ready for evaluation

---

## Summary

Beta.1 is the first public, feature-complete release of Legator. After 35+ alpha iterations building
out the core architecture, this release ships a stable, well-tested control plane that is ready for
real infrastructure deployments — at minimum in evaluation and staging environments.

The alpha track established: probe connectivity, policy engine, async job scheduling, MCP tool surface,
Grafana and Kubeflow adapters, federation, automation packs, and architecture boundary enforcement.
The pre-beta stages (3.9.1–4.0.3) added the reliability track, security hardening, database
migration framework, and a comprehensive docs freeze.

No Go source code is experimental in beta.1. All surfaces carry the additive compatibility contract
(introduced in Stage 3.5): existing routes, tool names, resource names, and field names will not
be removed or renamed without a documented deprecation window.

---

## Highlights

| Area | Details |
|------|---------|
| REST API | 60+ endpoints, all gated, body-limited, and documented |
| MCP tools | 40+ tools and resources across all surfaces |
| Probe types | 6 command types: shell, file read/write, process, systemd, kubectl |
| Data stores | 19 SQLite stores, all stamped with schema version 1 |
| Reliability | SLO scorecards, alert routing, failure drills, incident export |
| Security | Full auth coverage, body limits, credential sanitiser, WAL pragmas |
| Migrations | Versioned schema runner, backup, downgrade guard |
| Federation | Multi-cluster inventory, scoped auth, failover semantics |
| Automation | Declarative workflow schema, dry-run, guarded exec, rollback, audit |
| Docs | API reference, security model, MCP guide, deployment guide |

---

## What's New Since Last Alpha (v1.0.0-alpha.17)

### Stage 3.9.1 — SLO Definitions and Service Health Scorecards
- In-memory SLI telemetry sampling middleware for control-plane request metrics.
- `GET /api/v1/reliability/scorecard` with configurable `window` (default 15m).
- Additive `reliability` payload on `GET /api/v1/fleet/summary`.
- Per-indicator explainability metadata (target, warning, critical, comparator, window, rationale).

### Stage 3.9.2 — Alert Routing and Escalation Policy as Code
- `RoutingPolicy` and `EscalationPolicy` as persistable policy-as-code entities.
- Deterministic `Resolve(RoutingContext)` with full explainability (`matched_by`, `fallback_used`, `reason`).
- 11 new routing/escalation API routes.
- Alert engine delivery now wraps events in `DeliveredAlertEvent` with routing outcome (additive).
- Optional `severity` field on `AlertCondition` for severity-based routing matchers.

### Stage 3.9.3 — Failure Drills and Recovery Verification
- `DrillDefinition`/`DrillRunner` with 5 built-in failure scenarios: `probe_disconnect`,
  `db_write_failure`, `llm_timeout`, `websocket_flood`, `concurrent_job_storm`.
- `RecoveryVerifier` that validates system recovery after each drill.
- `DrillStore` for SQLite-backed drill run history.
- Injectable interface stubs — drills run fully in unit tests without real infrastructure.
- API: `POST /api/v1/reliability/drills/run`, `GET /api/v1/reliability/drills`.

### Stage 3.9.4 — Incident Export and Postmortem Bundle
- Incident lifecycle model: create, update, resolve, delete.
- `IncidentStore` (SQLite-backed) with structured severity/status fields.
- Postmortem bundle export: timeline, affected probes, alert history, drill results, remediation notes.
- API: `GET|POST /api/v1/incidents`, `GET|PUT|DELETE /api/v1/incidents/{id}`,
  `GET /api/v1/incidents/{id}/export`.
- 633-line test suite.

### Stage 4.0.1 — Security Hardening
- Authentication gates applied to all previously unprotected routes (full audit pass).
- `body_limit.go` middleware caps request bodies (default 4MB) across all routes.
- `internal/shared/security/sanitize.go` — strips credentials from error messages, logs, and payloads.
- SQLite pragma hardening: WAL mode, `synchronous=NORMAL`, `journal_mode=WAL` across all 19 stores.
- 210+ new auth-coverage tests; 74 body-limit tests.

### Stage 4.0.2 — Database Migration Framework
- `internal/controlplane/migration` package:
  - `migration.go`: `SchemaVersion`, `CurrentVersion`, `SetVersion`, `NeedsMigration`,
    `EnsureVersion` (idempotent), `CheckVersion` (downgrade guard).
  - `runner.go`: `Migration` struct, `Runner` with `Migrate`/`MigrateTo`/`Rollback` — each step
    in its own transaction with rollback on error.
  - `backup.go`: `BackupDatabase` (file copy + `PRAGMA integrity_check`), `CleanOldBackups`
    (age-based cleanup).
- All 19 SQLite store constructors stamped with `migration.EnsureVersion(db, 1)`.
- Downgrade guard: startup fails if binary schema version is older than the on-disk version.
- Full test coverage: schema read/write, idempotency, forward migration, rollback, backup integrity,
  downgrade guard, transaction safety.

### Stage 4.0.3 — Docs Freeze
- `docs/api-reference.md` — comprehensive reference for all 60+ REST endpoints with request/response
  schemas, permission gates, error codes, and compatibility annotations.
- `docs/security.md` — full security model: authentication layers, JWT validation, SQLite pragma
  hardening, body-limit middleware, credential sanitiser, threat model.
- `docs/mcp-tools.md` — all stable MCP tools and resources with usage examples and permission notes.
- `docs/deployment.md` — single-node binary, Docker Compose, and Kubernetes DaemonSet deployment
  paths with full environment variable reference.
- `README.md` — updated architecture diagram, quick-start, and cross-links to all doc surfaces.

---

## Known Limitations

1. **No Windows probe support yet.** The control plane runs on Windows but the probe systemd integration
   is Linux-only. Windows probe support is planned for beta.2.
2. **No official Docker image.** Build from source or use the binary release. An official image is
   planned for beta.2.
3. **SQLite only.** No PostgreSQL or MySQL backend. Planned for a future release.
4. **Single-node control plane.** High-availability (active-standby) is planned post-beta.
5. **UI is functional, not polished.** The operator dashboard covers all surfaces but has minimal
   styling. A design pass is planned for beta.2.
6. **Failure drills require care in production.** The `probe_disconnect` and `websocket_flood` drills
   send real signals — run them in non-critical environments or off-hours.

---

## What's Coming in Beta.2+

- Windows probe (systemd → Windows Service)
- Official Docker image and Helm chart
- PostgreSQL backend option
- HA control plane (leader election)
- Web UI design pass
- Additional drill scenarios (network partition, disk pressure)
- Expanded federation: write-model propagation
- Automation pack library (community-contributed packs)

---

## Upgrade Guide from Alpha

### From v1.0.0-alpha.17 or later

Beta.1 is backward-compatible at the API and probe protocol level. All alpha alpha probes will
reconnect and function correctly.

```bash
# Stop control plane
systemctl stop legator-control-plane   # or however you're running it

# Replace binary (if using binary release)
curl -Lo ./bin/control-plane \
  https://github.com/marcus-qen/legator/releases/download/v1.0.0-beta.1/legator-control-plane-linux-amd64
chmod +x ./bin/control-plane

# Start — migration runs automatically on first boot
./bin/control-plane
```

The migration framework (`EnsureVersion`) will stamp existing databases at schema version 1 on
first boot. This is a one-time, non-destructive operation. A backup is recommended before upgrading.

### From older alphas (pre-alpha.17)

Upgrade to alpha.17 first (to pick up the API compatibility contract), then upgrade to beta.1.

---

## Compatibility

All surfaces in beta.1 are covered by the additive compatibility contract
(`docs/api-reference.md`, `docs/contracts/api-v1-stable-routes.txt`,
`docs/contracts/mcp-stable-tools.txt`):

- REST routes, field names, and response shapes will not be removed or renamed without a
  documented deprecation window of at least one minor release.
- MCP tool names and resource URIs are stable.
- Probe wire protocol is backward-compatible with all alpha probes.

Breaking changes, when required, will be announced in CHANGELOG.md under a `### Breaking` section
with migration guidance.

---

## Building from Source

```bash
git clone https://github.com/marcus-qen/legator
cd legator
make          # builds control-plane, probe, legatorctl for current platform
make release-build   # cross-compiles linux/amd64 and linux/arm64
ls -lh bin/
```

Requirements: Go 1.22+, `make`, `gcc` (for CGo/SQLite).

---

## Testing

```bash
go test ./...    # all unit + integration tests
go vet ./...     # static analysis
```

Beta.1 ships with 200+ test suites covering all major surfaces.
